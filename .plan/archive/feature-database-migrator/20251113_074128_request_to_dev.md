**Important: Read `README.md` first to understand your role and workflow before starting this assignment.**

**Lifecycle Folder:** feature-database-migrator

**Requirements:** See `.lifecycle/feature-database-migrator/requirements.md` for detailed specifications

## Assignment: Fix Critical Schema Loading Issue

### Context

The code review identified **ONE CRITICAL BLOCKING ISSUE** in an otherwise excellent implementation. The review team praised the state machine implementation as "exemplary" with comprehensive test coverage and excellent code quality. However, the schema loading path will cause runtime failure.

**Review Status:** REQUIRES CHANGES (95% complete, one critical fix needed)
**Estimated Fix Time:** 10-15 minutes

### Critical Issue to Fix

**Issue #1: Schema Loading Path Mismatch**

**Locations:**
- `DirectGTD/Database.swift:47-49`
- `DirectGTDTests/DatabaseMigrationTests.swift:267-269`

**Current Code (problematic):**
```swift
guard let schemaURL = Bundle.main.url(forResource: "schema", withExtension: "sql") else {
    throw DatabaseError.schemaNotFound
}
```

**Problem:**
- The schema.sql file exists at `database/schema.sql` in the project
- It is NOT currently included in the app bundle's resources
- This will cause `.schemaNotFound` error on every database initialization
- All 6 test cases will fail with the same error

**Required Fix (Choose Option A):**

**Option A: Add to Bundle Resources (RECOMMENDED)**
1. Open Xcode project
2. Select DirectGTD target
3. Go to "Build Phases" tab
4. Expand "Copy Bundle Resources"
5. Click "+" to add `database/schema.sql`
6. Verify the file is copied to the bundle

**Option B: File-Based Loading (Alternative, less recommended)**
- Change to use file path approach instead of bundle loading
- Not recommended for production app distribution

**Apply the same fix to both locations:**
- Database.swift:47-49 (production code)
- DatabaseMigrationTests.swift:267-269 (test helper)

### Verification Required

After fixing, verify:

1. **Build succeeds** with no warnings about missing resources
2. **Run all 6 test cases** (TC1-TC6) to confirm schema loads correctly
3. **Check bundle contents** to verify schema.sql is included
4. **Test in simulator** to confirm migration works in real environment

### What Review Team Praised (No Changes Needed)

The review team's feedback was overwhelmingly positive on:

- ✅ **State machine: EXEMPLARY** - All 6 states correctly handled per specification
- ✅ **Edge cases: COMPREHENSIVE** - All 5 edge cases with explicit handling
- ✅ **Test coverage: EXCELLENT** - All 6 test cases properly implemented
- ✅ **Code quality: HIGH** - Excellent logging, error handling, architecture
- ✅ **Requirements compliance: 7/8** - Only schema loading issue found

**Do NOT change** the state detection logic, edge case handling, test implementations, or overall architecture. These are all correct and approved.

### Success Criteria for This Fix

Before marking complete, verify:

1. ✅ Schema file loads successfully from bundle (no `.schemaNotFound` error)
2. ✅ All 6 test cases pass (TC1-TC6)
3. ✅ Build succeeds with no warnings
4. ✅ Schema.sql file is included in app bundle
5. ✅ Both production code and test helper use same approach

### Expected Deliverables

**Status:** COMPLETE / BLOCKED

**Fix Summary:**
[Brief description of what was changed to resolve schema loading issue]

**Option Chosen:**
[Option A (bundle resources) OR Option B (file-based loading)]

**Verification Results:**
- [ ] Build succeeded with no warnings
- [ ] All 6 test cases pass (TC1-TC6)
- [ ] Schema.sql verified in bundle contents
- [ ] Tested in simulator (optional but recommended)

**Files Modified:**
[List files and line numbers changed]

**Testing Evidence:**
[Report test results showing all 6 test cases now pass]

**When completing this work, include a reminder in your response.md for the recipient to read their README.md as crucial process requirements are documented there.**
